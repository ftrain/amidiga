[env:teensy41]
platform = teensy
board = teensy41
framework = arduino

; C++ standard
build_flags =
    -std=c++17
    -DUSB_MIDI
    -DUSB_MIDI_SERIAL
    -Wall
    -Wextra
    -fno-exceptions
    -fno-rtti
    -DNO_EXCEPTIONS

; Library dependencies
lib_deps =
    ; Note: Lua needs to be added to lib/ directory as source
    ; Recommended: Download Lua 5.4 source and place in lib/lua/
    ; For now, trying luac library from PlatformIO registry

; Source directories - include all src files but filter out desktop-specific
src_dir = src
lib_dir = lib

; Filter to exclude desktop-specific files from build
src_filter =
    +<*>
    -<desktop/>

; Build options
build_unflags =
monitor_speed = 115200

; Optimization
build_type = release

; Upload options
upload_protocol = teensy-gui
upload_port = /dev/ttyACM0

; Debug options (optional)
debug_tool = jlink
debug_init_break = tbreak setup
